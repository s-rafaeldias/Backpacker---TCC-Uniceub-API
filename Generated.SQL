/*
Created: 18/03/2021
Modified: 24/03/2021
Model: MySQL 8.0
Database: MySQL 8.0
*/

-- Create tables section -------------------------------------------------

-- Table USUARIO

CREATE TABLE `USUARIO`
(
  `ID_USUARIO` Int NOT NULL,
  `EMAIL` Char(50) NOT NULL,
  `SENHA` Binary(60) NOT NULL,
  `ESTADO_CONTA` Char(1) NOT NULL,
  `NOME_USUARIO` Char(50),
  `SEXO` Char(1),
  `DT_NASCIMENTO` Date,
  `TS_ULTIMO_LOGIN` Timestamp NULL,
  `TS_CADASTRO` Timestamp NULL,
  `TS_ALTERACAO_PERFIL` Timestamp NULL
)
;

ALTER TABLE `USUARIO` ADD PRIMARY KEY (`ID_USUARIO`)
;

-- Table VIAGEM

CREATE TABLE `VIAGEM`
(
  `ID_VIAGEM` Int NOT NULL,
  `NOME_VIAGEM` Char(20),
  `ORCAMENTO_VIAGEM` Decimal(15,2),
  `DATA_INICIO` Date,
  `DATA_FIM` Date,
  `DESCRICAO` Char(255)
)
;

ALTER TABLE `VIAGEM` ADD PRIMARY KEY (`ID_VIAGEM`)
;

-- Table CATEGORIA_DOCUMENTO

CREATE TABLE `CATEGORIA_DOCUMENTO`
(
  `CD_CATEGORIA_DOCUMENTO` Int NOT NULL,
  `NOME_CATEGORIA` Char(20) NOT NULL
)
;

ALTER TABLE `CATEGORIA_DOCUMENTO` ADD PRIMARY KEY (`CD_CATEGORIA_DOCUMENTO`)
;

-- Table GASTO

CREATE TABLE `GASTO`
(
  `ID_GASTO` Int NOT NULL,
  `NOME_GASTO` Char(20),
  `DESCRICAO_GASTO` Char(255),
  `VALOR_GASTO` Decimal(15,2) NOT NULL,
  `LINK_IMAGEM_GASTO` Char(250)
)
;

ALTER TABLE `GASTO` ADD PRIMARY KEY (`ID_GASTO`)
;

-- Table TIPO_USUARIO

CREATE TABLE `TIPO_USUARIO`
(
  `CD_TIPO_USUARIO` Int NOT NULL,
  `NOME_TIPO` Char(20) NOT NULL
)
;

ALTER TABLE `TIPO_USUARIO` ADD PRIMARY KEY (`CD_TIPO_USUARIO`)
;

-- Table DOCUMENTO

CREATE TABLE `DOCUMENTO`
(
  `ID_DOCUMENTO` Int NOT NULL,
  `NOME_DOCUMENTO` Char(20),
  `LINK_IMAGEM_DOCUMENTO` Char(250),
  `CD_CATEGORIA_DOCUMENTO` Int NOT NULL
)
;

ALTER TABLE `DOCUMENTO` ADD PRIMARY KEY (`ID_DOCUMENTO`)
;

-- Table LOCAL

CREATE TABLE `LOCAL`
(
  `ID_LOCAL` Int NOT NULL,
  `DATA_PLANEJADA` Date,
  `VISITADO` Char(1) NOT NULL,
  `TS_VISITADO` Timestamp NULL,
  `DESCRICAO` Char(255)
)
;

ALTER TABLE `LOCAL` ADD PRIMARY KEY (`ID_LOCAL`)
;

-- Table VIAGENS_DO_USUARIO

CREATE TABLE `VIAGENS_DO_USUARIO`
(
  `ID_USUARIO` Int NOT NULL,
  `ID_VIAGEM` Int NOT NULL,
  `CD_TIPO` Int
)
;

CREATE INDEX `IX_Relationship3` ON `VIAGENS_DO_USUARIO` (`CD_TIPO`)
;

ALTER TABLE `VIAGENS_DO_USUARIO` ADD PRIMARY KEY (`ID_USUARIO`, `ID_VIAGEM`)
;

-- Table USUARIO_VIAGEM

CREATE TABLE `USUARIO_VIAGEM`
(
  `CD_TIPO` Int NOT NULL,
  `ID_USUARIO` Int NOT NULL,
  `ID_VIAGEM` Int NOT NULL
)
;

ALTER TABLE `USUARIO_VIAGEM` ADD PRIMARY KEY (`CD_TIPO`, `ID_USUARIO`, `ID_VIAGEM`)
;

-- Table VIAGEM_USUARIO

CREATE TABLE `VIAGEM_USUARIO`
(
  `ID_USUARIO` Int NOT NULL,
  `ID_VIAGEM` Int NOT NULL,
  `CD_TIPO_USUARIO` Int NOT NULL
)
;

ALTER TABLE `VIAGEM_USUARIO` ADD PRIMARY KEY (`ID_USUARIO`, `ID_VIAGEM`)
;

-- Table DOCUMENTO_VIAGEM

CREATE TABLE `DOCUMENTO_VIAGEM`
(
  `ID_VIAGEM` Int NOT NULL,
  `ID_DOCUMENTO` Int NOT NULL
)
;

ALTER TABLE `DOCUMENTO_VIAGEM` ADD PRIMARY KEY (`ID_VIAGEM`, `ID_DOCUMENTO`)
;

-- Table LOCAL_VIAGEM

CREATE TABLE `LOCAL_VIAGEM`
(
  `ID_VIAGEM` Int NOT NULL,
  `ID_LOCAL` Int NOT NULL
)
;

ALTER TABLE `LOCAL_VIAGEM` ADD PRIMARY KEY (`ID_VIAGEM`, `ID_LOCAL`)
;

-- Table VIAGEM_GASTO

CREATE TABLE `VIAGEM_GASTO`
(
  `ID_VIAGEM` Int NOT NULL,
  `ID_GASTO` Int NOT NULL
)
;

ALTER TABLE `VIAGEM_GASTO` ADD PRIMARY KEY (`ID_GASTO`, `ID_VIAGEM`)
;

-- Create foreign keys (relationships) section -------------------------------------------------

ALTER TABLE `VIAGENS_DO_USUARIO` ADD CONSTRAINT `Relationship1` FOREIGN KEY (`ID_USUARIO`) REFERENCES `USUARIO` (`ID_USUARIO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `VIAGENS_DO_USUARIO` ADD CONSTRAINT `Relationship2` FOREIGN KEY (`ID_VIAGEM`) REFERENCES `VIAGEM` (`ID_VIAGEM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `VIAGENS_DO_USUARIO` ADD CONSTRAINT `Relationship3` FOREIGN KEY (`CD_TIPO`) REFERENCES `TIPO_USUARIO` (`CD_TIPO_USUARIO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `USUARIO_VIAGEM` ADD CONSTRAINT `Relationship4` FOREIGN KEY (`CD_TIPO`) REFERENCES `TIPO_USUARIO` (`CD_TIPO_USUARIO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `USUARIO_VIAGEM` ADD CONSTRAINT `Relationship5` FOREIGN KEY (`ID_USUARIO`, `ID_VIAGEM`) REFERENCES `VIAGENS_DO_USUARIO` (`ID_USUARIO`, `ID_VIAGEM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `VIAGEM_USUARIO` ADD CONSTRAINT `` FOREIGN KEY (`ID_USUARIO`) REFERENCES `USUARIO` (`ID_USUARIO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `VIAGEM_USUARIO` ADD CONSTRAINT `` FOREIGN KEY (`ID_VIAGEM`) REFERENCES `VIAGEM` (`ID_VIAGEM`) ON DELETE RESTRICT ON UPDATE RESTRICT
; 

ALTER TABLE `VIAGEM_USUARIO` ADD CONSTRAINT `` FOREIGN KEY (`CD_TIPO_USUARIO`) REFERENCES `TIPO_USUARIO` (`CD_TIPO_USUARIO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `DOCUMENTO` ADD CONSTRAINT `` FOREIGN KEY (`CD_CATEGORIA_DOCUMENTO`) REFERENCES `CATEGORIA_DOCUMENTO` (`CD_CATEGORIA_DOCUMENTO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `DOCUMENTO_VIAGEM` ADD CONSTRAINT `` FOREIGN KEY (`ID_VIAGEM`) REFERENCES `VIAGEM` (`ID_VIAGEM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `DOCUMENTO_VIAGEM` ADD CONSTRAINT `` FOREIGN KEY (`ID_DOCUMENTO`) REFERENCES `DOCUMENTO` (`ID_DOCUMENTO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `LOCAL_VIAGEM` ADD CONSTRAINT `` FOREIGN KEY (`ID_VIAGEM`) REFERENCES `VIAGEM` (`ID_VIAGEM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `LOCAL_VIAGEM` ADD CONSTRAINT `` FOREIGN KEY (`ID_LOCAL`) REFERENCES `LOCAL` (`ID_LOCAL`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `VIAGEM_GASTO` ADD CONSTRAINT `` FOREIGN KEY (`ID_GASTO`) REFERENCES `GASTO` (`ID_GASTO`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

ALTER TABLE `VIAGEM_GASTO` ADD CONSTRAINT `` FOREIGN KEY (`ID_VIAGEM`) REFERENCES `VIAGEM` (`ID_VIAGEM`) ON DELETE RESTRICT ON UPDATE RESTRICT
;

